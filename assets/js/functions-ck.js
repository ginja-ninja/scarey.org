window.scarey=window.scarey||{};scarey.medium="screen and (min-width: 45em)";scarey.large="screen and (min-width: 90em)";scarey.fastclick={init:function(){if(matchMedia(scarey.large).matches)return;scarey.fastclick.go()},go:function(){$.getScript("/assets/js/libs/fastClick.js",function(){FastClick.attach(document.body)})}};scarey.scroll=function(e){$.scrollTo($(e),1e3,{easing:"easeInOutExpo",axis:"y",onAfter:function(){history.pushState(null,null,e)}})};scarey.nav=function(){var e=$("#nav"),t=$("#mobile-flyout");$(".more-nav").click(function(){t.hasClass("slide-in")?t.removeClass("slide-in").addClass("slide-out"):t.addClass("slide-in");$(".main-content").toggleClass("dark");event.preventDefault()})};scarey.albumFilter=function(){var e=$(".filter"),t=$(".filter__toggle"),n=$(".filter__close"),r=$(".filter__slider-wrap a"),i=location.hash,s;t.on("click",function(){e.toggleClass("showing")});n.on("click",function(){e.removeClass("showing")});r.on("click",function(t){s=$(this).attr("href");t.preventDefault();e.removeClass("showing");setTimeout(function(){scarey.scroll(s)},300)})};scarey.slider={init:function(){matchMedia(scarey.large).matches?scarey.carousel():scarey.swipe()}};scarey.carousel=function(){function g(e){f+=e;$(u).each(function(){$(this).removeClass("on")});$(u[f]).addClass("on")}function y(e){return e.substr(7,e.length-8).split(", ")}function b(e,n,s,o){h=y(t.css("transform"))[4];p=parseInt(h,10);e==="forward"?d=p-viewport_width*s:d=p+viewport_width*s;v=e==="forward"&&Math.abs(p)+viewport_width===r*i||e==="backward"&&p===0;if(v)return;if(Modernizr.csstransforms3d){t.css({"-webkit-transform":"translate3d("+d+"px, 0, 0)","-moz-transform":"translate3d("+d+"px,0,0)","-o-transform":"translate3d("+d+"px,0,0)","-ms-transform":"translate3d("+d+"px,0,0)",transform:"translate3d("+d+"px,0,0)"});o(n)}else{t.css({"-webkit-transform":"translateX("+d+"px)","-moz-transform":"translateX("+d+"px)","-o-transform":"translateX("+d+"px)","-ms-transform":"translateX("+d+"px)",transform:"translateX("+d+"px)"});o(n)}}var e=$(".filter__slider"),t=$(".filter__slider-wrap"),n=$(".filter__slider-wrap li"),r=n.innerWidth(),i=n.length,s=$(".prev"),o=$(".next"),u=[],a,f,l=$("#position"),c,h,p,d,v,m;matchMedia(scarey.large).matches?c=4:c=2;a=i/c;for(m=0;m<a;m++)l.append("<a class='bullet'></a>");$("#position a").each(function(){var e=$(this);u.push(e)});if(i<=c){viewport_width=r*i;$(".filter__controls").hide();$(u).each(function(){$(this).hide()})}else viewport_width=r*c;e.css("width",viewport_width);t.css("width",r*i);f=0;g(0);o.on("click",function(){b("forward",1,1,g)});s.on("click",function(){b("backward",-1,1,g)});$(u).each(function(e){$(this).on("click",function(){var t=e-f,n=Math.abs(t);if(e===f)return;e>f?b("forward",t,n,g):b("backward",t,n,g)})})};scarey.swipe=function(){var e=$("#slider li"),t=e.length,n,r=[],i=$("#position"),s;$(e).each(function(){i.append("<a class='bullet'></a>")});$("#position a ").each(function(){var e=$(this);r.push(e)});$("#position a:first-child").addClass("on");$(r).each(function(e){$(this).on("click",function(){mySwipe.slide(e,200)})});window.mySwipe=$("#slider").Swipe({continuous:!1,callback:function(e){var t=r.length;while(t--)r[t].removeClass("on");r[e].addClass("on")}}).data("Swipe")};scarey.stickyNav=function(){$(document).on("scroll",function(){var e=$(document).scrollTop();e>=500?$("#nav").hasClass("sticky")||$("#nav").addClass("sticky").css({top:"-300px"}).stop().animate({top:0},500):$("#nav").removeClass("sticky").removeAttr("style")})};scarey.history=function(e,t){var n=e.History,r=e.jQuery,i=e.document;if(!n.enabled)return!1;r(function(){var t=".wrap",s=r(t).filter(":first"),o=s.get(0),u=r(e),a=r(i.body),f=n.getRootUrl();s.length===0&&(s=a);r.expr[":"].internal=function(e){var t=r(e),n=t.attr("href")||"",i;i=n.substring(0,f.length)===f||n.indexOf(":")===-1;return i};var l=function(e){var t=String(e).replace(/<\!DOCTYPE[^>]*>/i,"").replace(/<(html|head|body|title|meta|script)([\s\>])/gi,'<div class="document-$1"$2').replace(/<\/(html|head|body|title|meta|script)\>/gi,"</div>");return t};r.fn.ajaxify=function(){var e=r(this);e.find(".page-nav a").click(function(e){var t=r(this),i=t.attr("href"),s=t.attr("title")||null;if(e.which===2||e.metaKey)return!0;n.pushState(null,s,i);e.preventDefault();return!1});return e};a.ajaxify();u.bind("statechange",function(){var u=n.getState(),a=u.url,f;r(".main-content").removeClass("slide-fade-from-left");r(".main-content").addClass("slide-fade-to-right");r.ajax({url:a,success:function(n){var u=r(l(n)),f=u.find(".document-body:first"),c=f.find(t).filter(":first"),h,p;p=c.find(".document-script");p.length&&p.detach();h=c.html()||u.html();if(!h){i.location.href=a;return!1}s.html(h).ajaxify();scarey.nav();scarey.albumFilter();scarey.slider.init();scarey.flipper();i.title=u.find(".document-title:first").text();try{i.getElementsByTagName("title")[0].innerHTML=i.title.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(d){}p.each(function(){var e=r(this),t=e.text(),n=e.attr("src"),s=i.createElement("script");if(n){s.src=n;o.appendChild(s)}else{s.appendChild(i.createTextNode(t));o.appendChild(s)}});r(".main-content").removeClass("slide-fade-to-right");r(".main-content").addClass("slide-fade-from-left");typeof e._gaq!="undefined"&&e._gaq.push(["_trackPageview",relativeUrl])},error:function(e){i.location.href=a;return!1}})})})}(window);scarey.colorbox={init:function(){if(!matchMedia(scarey.medium).matches)return;$.getScript("/assets/js/libs/colorbox.js",function(){scarey.colorbox.go()})},go:function(){$(".photo-container a").colorbox({rel:"group",scalePhotos:!0,maxHeight:"900px",speed:200,opacity:".7"})}};scarey.flipper=function(){var e=$(".album-cover");e.on("click",function(){$(this).toggleClass("album-cover--flipped")})};scarey.blog=function(){$(".post-content p").each(function(){var e=$(this).text().split(" ").length;if(e>=10){$(this).css("text-align","justify");$(this).siblings().css("text-align","justify")}})};$(document).ready(function(){scarey.nav();scarey.stickyNav();scarey.albumFilter();scarey.slider.init();scarey.colorbox.init();scarey.blog();scarey.fastclick.init();scarey.flipper()});