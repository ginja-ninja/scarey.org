window.scarey=window.scarey||{},scarey.medium="screen and (min-width: 50em)",scarey.large="screen and (min-width: 75em)",scarey.debounce=function(e,t,a){var r,n=a||500;$(window).on(e,function(){r&&clearTimeout(r),r=setTimeout(t,n)})},scarey.nav=function(){var e=($("#nav"),$("#mobile-flyout")),t=$("body");$(".more-nav").click(function(){e.toggleClass("nav--active"),t.toggleClass("nav--active"),$(".main-content").toggleClass("dark"),event.preventDefault()})},scarey.history=function(e,t){var a=e.History,r=e.jQuery,n=e.document;return!!a.enabled&&void r(function(){var t=".wrap",s=r(t).filter(":first"),o=s.get(0),i=r(e),l=r(n.body),c=a.getRootUrl();0===s.length&&(s=l),r.expr[":"].internal=function(e){var t,a=r(e),n=a.attr("href")||"";return t=n.substring(0,c.length)===c||n.indexOf(":")===-1};var d=function(e){var t=String(e).replace(/<\!DOCTYPE[^>]*>/i,"").replace(/<(html|head|body|title|meta|script)([\s\>])/gi,'<div class="document-$1"$2').replace(/<\/(html|head|body|title|meta|script)\>/gi,"</div>");return t};r.fn.ajaxify=function(){var e=r(this);return e.find(".page-nav a").click(function(e){var t=r(this),n=t.attr("href"),s=t.attr("title")||null;return!(2!==e.which&&!e.metaKey)||(a.pushState(null,s,n),e.preventDefault(),!1)}),e},l.ajaxify(),i.bind("statechange",function(){function i(){r.ajax({url:u,success:function(a){var i,l,c=r(d(a)),f=c.find(".document-body:first"),m=f.find(t).filter(":first");if(l=m.find(".document-script"),l.length&&l.detach(),i=m.html()||c.html(),!i)return n.location.href=u,!1;s.html(i).ajaxify(),scarey.reload(),n.title=c.find(".document-title:first").text();try{n.getElementsByTagName("title")[0].innerHTML=n.title.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(g){}l.each(function(){var e=r(this),t=e.text(),a=e.attr("src"),s=n.createElement("script");a?(s.src=a,o.appendChild(s)):(s.appendChild(n.createTextNode(t)),o.appendChild(s))}),r(".main-content").addClass("slide-fade-from-left"),"undefined"!=typeof e._gaq&&e._gaq.push(["_trackPageview",p])},error:function(e){return n.location.href=u,!1}})}var l=a.getState(),u=l.url,p=u.replace(c,"");r(".main-content").addClass("slide-fade-to-right"),setTimeout(i,300)})})}(window),scarey.visitorCheck=function(){var e=($("body"),$("#slide-from-left-1")),t=$("#slide-from-left-2"),a=$("#slide-from-right"),r=$("#slide-from-bottom"),n=$("#slide-from-bottom-2");"localStorage"in window&&null!==window.localStorage&&(!localStorage.getItem("returning_visitor")==!0?(e.addClass("slide-fade-from-left"),t.addClass("slide-fade-from-left"),a.addClass("slide-fade-from-right"),r.addClass("slide-fade-from-bottom"),n.addClass("slide-fade-from-bottom"),localStorage.setItem("returning_visitor",!0)):(e.css("opacity",1),t.css("opacity",1),a.css("opacity",1),r.css("opacity",1),n.css("opacity",1)))},scarey.collapse=function(){if($(".collapse__trigger")){var e=$(".collapse__trigger");e.on("click",function(){$(this).toggleClass("bold"),$(this).parent().toggleClass("collapse--collapsed"),$(this).next().toggleClass("collapse__content--showing")})}},scarey.tour=function(){function e(e){return e<10?"0"+e:e}function t(){o.hide(),s.append('<p class="center italic">No currently scheduled shows.</p>')}function a(e){function t(e){var t;t=e.ticket_url?'<a class="underlined-link" target="_blank" href="'+e.ticket_url+'">'+e.venue.name+"</a>":e.venue.name,f.append('<p class="tour-date">'+p+'</p><p class="tour-city">'+e.formatted_location+'</p><p class="tour-venue">'+t+'<span class="bold"> '+e.support.denoter+"</span></p>"),o.append(f)}function a(){var e=$("<div>").attr("class","tour-support");for(var t in s)e.append('<p><span class="bold">'+s[t]+" </span>w/ "+t+"</p>");e.insertBefore(o)}var r,n,s={},i=0,l=["*","^","#"],c=0;for(r=0;r<e.length;r++){var d=e[r];d.support={};var u=/(january|february|march|april|may|june|july|august|september|october|november|december)\s(\d+),\s(\d){4}/i,p=d.formatted_datetime.match(u)[0],f=$("<div>").attr("class","tour-event");if(d.artists.length>1)for(var m=1;m<d.artists.length;m++)s[d.artists[m].name]||(l[i]||(n=l[c],n+=n.split("")[0],c++,l.push(n)),s[d.artists[m].name]=l[i],i++),d.support.name=d.artists[m].name,d.support.denoter=s[d.support.name]||"*";else d.support.denoter="";t(d)}a()}if($(".tour--upcoming").length||$(".tour--past").length){var r,n="scarey.org",s=$(".tour .main-content"),o=$(".tour-block");if($(".tour--upcoming").length)r="upcoming";else if($(".tour--past").length){r="2011-01-01,";var i=new Date,l=i.getFullYear(),c=e(i.getMonth()+1),d=e(i.getDate()-1);r+=l+"-"+c+"-"+d}s.addClass("loading");var u=$.ajax({type:"GET",dataType:"jsonp",url:"http://api.bandsintown.com/artists/S Carey/events.json?api_version=2.0&date="+r+"&app_id="+n,timeout:8e3});u.done(function(e){e.length?a(e):t()}),u.fail(function(e,t){s.append('<p class="center">There was an error requesting the data from Bands In Town.  Please try again or visit this link: </p><p class="center"><a target="_blank" href="http://www.bandsintown.com/S.Carey">http://www.bandsintown.com/S.Carey</a></p>')}),u.always(function(e){s.removeClass("loading")})}},scarey.reload=function(){scarey.nav(),scarey.visitorCheck(),scarey.collapse(),scarey.tour()},$(document).ready(function(){scarey.nav(),scarey.visitorCheck(),scarey.collapse(),scarey.tour()});